{
   "library" : {
      "identifier" : {
         "id" : "Factors_to_Consider_in_Managing_Chronic_Pain",
         "version" : "1.0.0"
      },
      "schemaIdentifier" : {
         "id" : "urn:hl7-org:elm",
         "version" : "r1"
      },
      "usings" : {
         "def" : [ {
            "localIdentifier" : "System",
            "uri" : "urn:hl7-org:elm-types:r1"
         }, {
            "localIdentifier" : "FHIR",
            "uri" : "http://hl7.org/fhir",
            "version" : "1.0.2"
         } ]
      },
      "includes" : {
         "def" : [ {
            "localIdentifier" : "C3F",
            "path" : "CDS_Connect_Commons_for_FHIRv102",
            "version" : "1.3.0"
         }, {
            "localIdentifier" : "FHIRHelpers",
            "path" : "FHIRHelpers",
            "version" : "1.0.2"
         } ]
      },
      "parameters" : {
         "def" : [ {
            "name" : "InclusionMedicationsLookbackPeriod",
            "accessLevel" : "Public",
            "default" : {
               "value" : 180,
               "unit" : "days",
               "type" : "Quantity"
            }
         } ]
      },
      "codeSystems" : {
         "def" : [ {
            "name" : "LOINC",
            "id" : "http://loinc.org",
            "accessLevel" : "Public"
         }, {
            "name" : "SNOMED-CT",
            "id" : "http://snomed.info/sct",
            "accessLevel" : "Public"
         }, {
            "name" : "LOCAL",
            "id" : "http://cds.ahrq.gov/cdsconnect/pms",
            "accessLevel" : "Public"
         } ]
      },
      "valueSets" : {
         "def" : [ {
            "name" : "Conditions associated with chronic pain",
            "id" : "2.16.840.1.113762.1.4.1032.37",
            "accessLevel" : "Public"
         }, {
            "name" : "Opioid Pain Medications",
            "id" : "2.16.840.1.113762.1.4.1032.34",
            "accessLevel" : "Public"
         }, {
            "name" : "Adjuvant Analgesic Medications",
            "id" : "2.16.840.1.113762.1.4.1032.54",
            "accessLevel" : "Public"
         }, {
            "name" : "Major Depression",
            "id" : "2.16.840.1.113883.3.464.1003.105.12.1007",
            "accessLevel" : "Public"
         }, {
            "name" : "Anxiety",
            "id" : "2.16.840.1.113762.1.4.1032.52",
            "accessLevel" : "Public"
         }, {
            "name" : "Substance use disorder",
            "id" : "2.16.840.1.113883.3.464.1003.106.12.1004",
            "accessLevel" : "Public"
         }, {
            "name" : "Suicide attempt",
            "id" : "2.16.840.1.113762.1.4.1032.40",
            "accessLevel" : "Public"
         }, {
            "name" : "Sleep-disordered breathing",
            "id" : "2.16.840.1.113762.1.4.1032.53",
            "accessLevel" : "Public"
         }, {
            "name" : "Kidney Failure",
            "id" : "2.16.840.1.113883.3.464.1003.109.12.1028",
            "accessLevel" : "Public"
         }, {
            "name" : "Chronic Liver Disease",
            "id" : "2.16.840.1.113883.3.464.1003.199.12.1035",
            "accessLevel" : "Public"
         }, {
            "name" : "Liver Disease",
            "id" : "2.16.840.1.113762.1.4.1047.42",
            "accessLevel" : "Public"
         }, {
            "name" : "Pregnancy",
            "id" : "2.16.840.1.113883.3.526.3.378",
            "accessLevel" : "Public"
         }, {
            "name" : "Non opiod pain medications",
            "id" : "2.16.840.1.113762.1.4.1032.26",
            "accessLevel" : "Public"
         }, {
            "name" : "Non pharmacologic treatments for chronic pain",
            "id" : "2.16.840.1.113762.1.4.1032.36",
            "accessLevel" : "Public"
         }, {
            "name" : "Risk assessments relevant to pain management",
            "id" : "2.16.840.1.113762.1.4.1032.55",
            "accessLevel" : "Public"
         }, {
            "name" : "Benzodiazepine medications",
            "id" : "2.16.840.1.113762.1.4.1032.43",
            "accessLevel" : "Public"
         }, {
            "name" : "Naloxone medications",
            "id" : "2.16.840.1.113762.1.4.1032.42",
            "accessLevel" : "Public"
         }, {
            "name" : "Urine drug screen for pain management",
            "id" : "2.16.840.1.113762.1.4.1032.28",
            "accessLevel" : "Public"
         }, {
            "name" : "Stool softeners and laxatives",
            "id" : "2.16.840.1.113762.1.4.1032.44",
            "accessLevel" : "Public"
         } ]
      },
      "codes" : {
         "def" : [ {
            "name" : "Pregnancy status code",
            "id" : "82810-3",
            "display" : "Pregnancy status",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Pregnant code",
            "id" : "77386006",
            "display" : "Patient currently pregnant (finding)",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "SNOMED-CT"
            }
         }, {
            "name" : "Suicidal deliberate poisoning code",
            "id" : "86849004",
            "display" : "Suicidal deliberate poisoning",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "SNOMED-CT"
            }
         }, {
            "name" : "Patient Health Questionnaire 2 item (PHQ-2) total score [Reported] code",
            "id" : "55758-7",
            "display" : "Patient Health Questionnaire 2 item (PHQ-2) total score [Reported]",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Patient Health Questionnaire 9 item (PHQ-9) total score [Reported] code",
            "id" : "44261-6",
            "display" : "Patient Health Questionnaire 9 item (PHQ-9) total score [Reported]",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Generalized anxiety disorder 7 item (GAD-7) total score [Reported.PHQ] code",
            "id" : "70274-6",
            "display" : "Generalized anxiety disorder 7 item (GAD-7) total score [Reported.PHQ]",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Total score [AUDIT] code",
            "id" : "75624-7",
            "display" : "Total score [AUDIT]",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Total score [AUDIT-C] code",
            "id" : "75626-2",
            "display" : "Total score [AUDIT-C]",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Total score [DAST-10] code",
            "id" : "82667-7",
            "display" : "Total score [DAST-10]",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Pain severity Wong-Baker FACES Scale code",
            "id" : "38221-8",
            "display" : "Pain severity Wong-Baker FACES Scale",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Pain Enjoyment General Activity (PEG) Assessment code",
            "id" : "PEGASSESSMENT",
            "display" : "Pain Enjoyment General Activity (PEG) Assessment",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Pain code",
            "id" : "PEGPAIN",
            "display" : "Pain",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Enjoyment of life code",
            "id" : "PEGENJOYMENT",
            "display" : "Enjoyment of life",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "General activity code",
            "id" : "PEGGENERALACTIVITY",
            "display" : "General activity",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "STarT Back Screening Tool code",
            "id" : "STARTBACK",
            "display" : "STarT Back Screening Tool",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Single question r/t ETOH use code",
            "id" : "SQETOHUSE",
            "display" : "Single question r/t ETOH use",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Single question r/t drug use code",
            "id" : "SQDRUGUSE",
            "display" : "Single question r/t drug use",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Morphine Milligram Equivalent (MME) code",
            "id" : "MME",
            "display" : "Morphine Milligram Equivalent (MME)",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         } ]
      },
      "concepts" : {
         "def" : [ {
            "name" : "Pregnancy status",
            "display" : "Pregnancy status",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pregnancy status code"
            } ]
         }, {
            "name" : "Pregnant",
            "display" : "Patient currently pregnant (finding)",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pregnant code"
            } ]
         }, {
            "name" : "Suicidal deliberate poisoning",
            "display" : "Suicidal deliberate poisoning",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Suicidal deliberate poisoning code"
            } ]
         }, {
            "name" : "Patient Health Questionnaire 2 item (PHQ-2) total score [Reported]",
            "display" : "Patient Health Questionnaire 2 item (PHQ-2) total score [Reported]",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Patient Health Questionnaire 2 item (PHQ-2) total score [Reported] code"
            } ]
         }, {
            "name" : "Patient Health Questionnaire 9 item (PHQ-9) total score [Reported]",
            "display" : "Patient Health Questionnaire 9 item (PHQ-9) total score [Reported]",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Patient Health Questionnaire 9 item (PHQ-9) total score [Reported] code"
            } ]
         }, {
            "name" : "Generalized anxiety disorder 7 item (GAD-7) total score [Reported.PHQ]",
            "display" : "Generalized anxiety disorder 7 item (GAD-7) total score [Reported.PHQ]",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Generalized anxiety disorder 7 item (GAD-7) total score [Reported.PHQ] code"
            } ]
         }, {
            "name" : "Total score [AUDIT]",
            "display" : "Total score [AUDIT]",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Total score [AUDIT] code"
            } ]
         }, {
            "name" : "Total score [AUDIT-C]",
            "display" : "Total score [AUDIT-C]",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Total score [AUDIT-C] code"
            } ]
         }, {
            "name" : "Total score [DAST-10]",
            "display" : "Total score [DAST-10]",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Total score [DAST-10] code"
            } ]
         }, {
            "name" : "Pain severity Wong-Baker FACES Scale",
            "display" : "Pain severity Wong-Baker FACES Scale",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pain severity Wong-Baker FACES Scale code"
            } ]
         }, {
            "name" : "Pain Enjoyment General Activity (PEG) Assessment",
            "display" : "Pain Enjoyment General Activity (PEG) Assessment",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pain Enjoyment General Activity (PEG) Assessment code"
            } ]
         }, {
            "name" : "Pain",
            "display" : "Pain",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pain code"
            } ]
         }, {
            "name" : "Enjoyment of life",
            "display" : "Enjoyment of life",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Enjoyment of life code"
            } ]
         }, {
            "name" : "General activity",
            "display" : "General activity",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "General activity code"
            } ]
         }, {
            "name" : "STarT Back Screening Tool",
            "display" : "STarT Back Screening Tool",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "STarT Back Screening Tool code"
            } ]
         }, {
            "name" : "Single question r/t ETOH use",
            "display" : "Single question r/t ETOH use",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Single question r/t ETOH use code"
            } ]
         }, {
            "name" : "Single question r/t drug use",
            "display" : "Single question r/t drug use",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Single question r/t drug use code"
            } ]
         }, {
            "name" : "Morphine Milligram Equivalent (MME)",
            "display" : "Morphine Milligram Equivalent (MME)",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Morphine Milligram Equivalent (MME) code"
            } ]
         } ]
      },
      "statements" : {
         "def" : [ {
            "name" : "Patient",
            "context" : "Patient",
            "expression" : {
               "type" : "SingletonFrom",
               "operand" : {
                  "dataType" : "{http://hl7.org/fhir}Patient",
                  "type" : "Retrieve"
               }
            }
         }, {
            "name" : "ConceptText",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Coalesce",
               "operand" : [ {
                  "path" : "value",
                  "type" : "Property",
                  "source" : {
                     "path" : "text",
                     "type" : "Property",
                     "source" : {
                        "name" : "c",
                        "type" : "OperandRef"
                     }
                  }
               }, {
                  "type" : "Coalesce",
                  "operand" : [ {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "c2",
                        "expression" : {
                           "path" : "coding",
                           "type" : "Property",
                           "source" : {
                              "name" : "c",
                              "type" : "OperandRef"
                           }
                        }
                     } ],
                     "relationship" : [ ],
                     "return" : {
                        "expression" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "display",
                              "scope" : "c2",
                              "type" : "Property"
                           }
                        }
                     }
                  } ]
               } ]
            },
            "operand" : [ {
               "name" : "c",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}CodeableConcept",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "ConceptTextWithRange",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "type" : "Equivalent",
                     "operand" : [ {
                        "name" : "ToConcept",
                        "libraryName" : "FHIRHelpers",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "name" : "c",
                           "type" : "OperandRef"
                        } ]
                     }, {
                        "name" : "Patient Health Questionnaire 2 item (PHQ-2) total score [Reported]",
                        "type" : "ConceptRef"
                     } ]
                  }
               },
               "then" : {
                  "type" : "Concatenate",
                  "operand" : [ {
                     "name" : "ConceptText",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "name" : "c",
                        "type" : "OperandRef"
                     } ]
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : " [Range: 0-6]",
                     "type" : "Literal"
                  } ]
               },
               "else" : {
                  "type" : "If",
                  "condition" : {
                     "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                     "type" : "As",
                     "operand" : {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToConcept",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "c",
                              "type" : "OperandRef"
                           } ]
                        }, {
                           "name" : "Patient Health Questionnaire 9 item (PHQ-9) total score [Reported]",
                           "type" : "ConceptRef"
                        } ]
                     }
                  },
                  "then" : {
                     "type" : "Concatenate",
                     "operand" : [ {
                        "name" : "ConceptText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "name" : "c",
                           "type" : "OperandRef"
                        } ]
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : " [Range: 0-27]",
                        "type" : "Literal"
                     } ]
                  },
                  "else" : {
                     "type" : "If",
                     "condition" : {
                        "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                        "type" : "As",
                        "operand" : {
                           "type" : "Equivalent",
                           "operand" : [ {
                              "name" : "ToConcept",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "name" : "c",
                                 "type" : "OperandRef"
                              } ]
                           }, {
                              "name" : "Generalized anxiety disorder 7 item (GAD-7) total score [Reported.PHQ]",
                              "type" : "ConceptRef"
                           } ]
                        }
                     },
                     "then" : {
                        "type" : "Concatenate",
                        "operand" : [ {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "c",
                              "type" : "OperandRef"
                           } ]
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : " [Range: 0-21]",
                           "type" : "Literal"
                        } ]
                     },
                     "else" : {
                        "type" : "If",
                        "condition" : {
                           "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                           "type" : "As",
                           "operand" : {
                              "type" : "Equivalent",
                              "operand" : [ {
                                 "name" : "ToConcept",
                                 "libraryName" : "FHIRHelpers",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "name" : "c",
                                    "type" : "OperandRef"
                                 } ]
                              }, {
                                 "name" : "Total score [AUDIT]",
                                 "type" : "ConceptRef"
                              } ]
                           }
                        },
                        "then" : {
                           "type" : "Concatenate",
                           "operand" : [ {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "name" : "c",
                                 "type" : "OperandRef"
                              } ]
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}String",
                              "value" : " [Range: 0-40]",
                              "type" : "Literal"
                           } ]
                        },
                        "else" : {
                           "type" : "If",
                           "condition" : {
                              "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                              "type" : "As",
                              "operand" : {
                                 "type" : "Equivalent",
                                 "operand" : [ {
                                    "name" : "ToConcept",
                                    "libraryName" : "FHIRHelpers",
                                    "type" : "FunctionRef",
                                    "operand" : [ {
                                       "name" : "c",
                                       "type" : "OperandRef"
                                    } ]
                                 }, {
                                    "name" : "Total score [AUDIT-C]",
                                    "type" : "ConceptRef"
                                 } ]
                              }
                           },
                           "then" : {
                              "type" : "Concatenate",
                              "operand" : [ {
                                 "name" : "ConceptText",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "name" : "c",
                                    "type" : "OperandRef"
                                 } ]
                              }, {
                                 "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                 "value" : " [Range: 0-12]",
                                 "type" : "Literal"
                              } ]
                           },
                           "else" : {
                              "type" : "If",
                              "condition" : {
                                 "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                                 "type" : "As",
                                 "operand" : {
                                    "type" : "Equivalent",
                                    "operand" : [ {
                                       "name" : "ToConcept",
                                       "libraryName" : "FHIRHelpers",
                                       "type" : "FunctionRef",
                                       "operand" : [ {
                                          "name" : "c",
                                          "type" : "OperandRef"
                                       } ]
                                    }, {
                                       "name" : "Total score [DAST-10]",
                                       "type" : "ConceptRef"
                                    } ]
                                 }
                              },
                              "then" : {
                                 "type" : "Concatenate",
                                 "operand" : [ {
                                    "name" : "ConceptText",
                                    "type" : "FunctionRef",
                                    "operand" : [ {
                                       "name" : "c",
                                       "type" : "OperandRef"
                                    } ]
                                 }, {
                                    "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                    "value" : " [Range: 0-10]",
                                    "type" : "Literal"
                                 } ]
                              },
                              "else" : {
                                 "type" : "If",
                                 "condition" : {
                                    "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                                    "type" : "As",
                                    "operand" : {
                                       "type" : "Equivalent",
                                       "operand" : [ {
                                          "name" : "ToConcept",
                                          "libraryName" : "FHIRHelpers",
                                          "type" : "FunctionRef",
                                          "operand" : [ {
                                             "name" : "c",
                                             "type" : "OperandRef"
                                          } ]
                                       }, {
                                          "name" : "Pain severity Wong-Baker FACES Scale",
                                          "type" : "ConceptRef"
                                       } ]
                                    }
                                 },
                                 "then" : {
                                    "type" : "Concatenate",
                                    "operand" : [ {
                                       "name" : "ConceptText",
                                       "type" : "FunctionRef",
                                       "operand" : [ {
                                          "name" : "c",
                                          "type" : "OperandRef"
                                       } ]
                                    }, {
                                       "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                       "value" : " [Range: 0-10]",
                                       "type" : "Literal"
                                    } ]
                                 },
                                 "else" : {
                                    "type" : "If",
                                    "condition" : {
                                       "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                                       "type" : "As",
                                       "operand" : {
                                          "type" : "Equivalent",
                                          "operand" : [ {
                                             "name" : "ToConcept",
                                             "libraryName" : "FHIRHelpers",
                                             "type" : "FunctionRef",
                                             "operand" : [ {
                                                "name" : "c",
                                                "type" : "OperandRef"
                                             } ]
                                          }, {
                                             "name" : "Pain Enjoyment General Activity (PEG) Assessment",
                                             "type" : "ConceptRef"
                                          } ]
                                       }
                                    },
                                    "then" : {
                                       "type" : "Concatenate",
                                       "operand" : [ {
                                          "name" : "ConceptText",
                                          "type" : "FunctionRef",
                                          "operand" : [ {
                                             "name" : "c",
                                             "type" : "OperandRef"
                                          } ]
                                       }, {
                                          "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                          "value" : " [Range: 0-10]",
                                          "type" : "Literal"
                                       } ]
                                    },
                                    "else" : {
                                       "type" : "If",
                                       "condition" : {
                                          "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                                          "type" : "As",
                                          "operand" : {
                                             "type" : "Equivalent",
                                             "operand" : [ {
                                                "name" : "ToConcept",
                                                "libraryName" : "FHIRHelpers",
                                                "type" : "FunctionRef",
                                                "operand" : [ {
                                                   "name" : "c",
                                                   "type" : "OperandRef"
                                                } ]
                                             }, {
                                                "name" : "STarT Back Screening Tool",
                                                "type" : "ConceptRef"
                                             } ]
                                          }
                                       },
                                       "then" : {
                                          "type" : "Concatenate",
                                          "operand" : [ {
                                             "name" : "ConceptText",
                                             "type" : "FunctionRef",
                                             "operand" : [ {
                                                "name" : "c",
                                                "type" : "OperandRef"
                                             } ]
                                          }, {
                                             "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                             "value" : " [Range: 0-9]",
                                             "type" : "Literal"
                                          } ]
                                       },
                                       "else" : {
                                          "name" : "ConceptText",
                                          "type" : "FunctionRef",
                                          "operand" : [ {
                                             "name" : "c",
                                             "type" : "OperandRef"
                                          } ]
                                       }
                                    }
                                 }
                              }
                           }
                        }
                     }
                  }
               }
            },
            "operand" : [ {
               "name" : "c",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}CodeableConcept",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "DateText",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "ToString",
               "operand" : {
                  "path" : "value",
                  "type" : "Property",
                  "source" : {
                     "name" : "d",
                     "type" : "OperandRef"
                  }
               }
            },
            "operand" : [ {
               "name" : "d",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}date",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "DateTimeText",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "ToString",
               "operand" : {
                  "path" : "value",
                  "type" : "Property",
                  "source" : {
                     "name" : "d",
                     "type" : "OperandRef"
                  }
               }
            },
            "operand" : [ {
               "name" : "d",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}dateTime",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "InstantText",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "ToString",
               "operand" : {
                  "path" : "value",
                  "type" : "Property",
                  "source" : {
                     "name" : "i",
                     "type" : "OperandRef"
                  }
               }
            },
            "operand" : [ {
               "name" : "i",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}instant",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "QuantityText",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "name" : "q",
                        "type" : "OperandRef"
                     }
                  }
               },
               "then" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}String",
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  }
               },
               "else" : {
                  "type" : "If",
                  "condition" : {
                     "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                     "type" : "As",
                     "operand" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "unit",
                              "type" : "Property",
                              "source" : {
                                 "name" : "q",
                                 "type" : "OperandRef"
                              }
                           }
                        }
                     }
                  },
                  "then" : {
                     "type" : "Concatenate",
                     "operand" : [ {
                        "type" : "Concatenate",
                        "operand" : [ {
                           "type" : "ToString",
                           "operand" : {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "q",
                                    "type" : "OperandRef"
                                 }
                              }
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : " ",
                           "type" : "Literal"
                        } ]
                     }, {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "path" : "unit",
                           "type" : "Property",
                           "source" : {
                              "name" : "q",
                              "type" : "OperandRef"
                           }
                        }
                     } ]
                  },
                  "else" : {
                     "type" : "If",
                     "condition" : {
                        "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                        "type" : "As",
                        "operand" : {
                           "type" : "Not",
                           "operand" : {
                              "type" : "IsNull",
                              "operand" : {
                                 "path" : "code",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "q",
                                    "type" : "OperandRef"
                                 }
                              }
                           }
                        }
                     },
                     "then" : {
                        "type" : "Concatenate",
                        "operand" : [ {
                           "type" : "Concatenate",
                           "operand" : [ {
                              "type" : "ToString",
                              "operand" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "q",
                                       "type" : "OperandRef"
                                    }
                                 }
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}String",
                              "value" : " ",
                              "type" : "Literal"
                           } ]
                        }, {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "q",
                                 "type" : "OperandRef"
                              }
                           }
                        } ]
                     },
                     "else" : {
                        "type" : "ToString",
                        "operand" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "name" : "q",
                                 "type" : "OperandRef"
                              }
                           }
                        }
                     }
                  }
               }
            },
            "operand" : [ {
               "name" : "q",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Quantity",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "PeriodObject",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "name" : "p",
                        "type" : "OperandRef"
                     }
                  }
               },
               "then" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  },
                  "asTypeSpecifier" : {
                     "type" : "TupleTypeSpecifier",
                     "element" : [ {
                        "name" : "Start",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "End",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     } ]
                  }
               },
               "else" : {
                  "type" : "Tuple",
                  "element" : [ {
                     "name" : "Start",
                     "value" : {
                        "name" : "DateTimeText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "start",
                           "type" : "Property",
                           "source" : {
                              "name" : "p",
                              "type" : "OperandRef"
                           }
                        } ]
                     }
                  }, {
                     "name" : "End",
                     "value" : {
                        "name" : "DateTimeText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "end",
                           "type" : "Property",
                           "source" : {
                              "name" : "p",
                              "type" : "OperandRef"
                           }
                        } ]
                     }
                  } ]
               }
            },
            "operand" : [ {
               "name" : "p",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Period",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "RangeObject",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "name" : "r",
                        "type" : "OperandRef"
                     }
                  }
               },
               "then" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  },
                  "asTypeSpecifier" : {
                     "type" : "TupleTypeSpecifier",
                     "element" : [ {
                        "name" : "Low",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "High",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     } ]
                  }
               },
               "else" : {
                  "type" : "Tuple",
                  "element" : [ {
                     "name" : "Low",
                     "value" : {
                        "name" : "QuantityText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "low",
                           "type" : "Property",
                           "source" : {
                              "name" : "r",
                              "type" : "OperandRef"
                           }
                        } ]
                     }
                  }, {
                     "name" : "High",
                     "value" : {
                        "name" : "QuantityText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "high",
                           "type" : "Property",
                           "source" : {
                              "name" : "r",
                              "type" : "OperandRef"
                           }
                        } ]
                     }
                  } ]
               }
            },
            "operand" : [ {
               "name" : "r",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Range",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "ObservationDate",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Coalesce",
               "operand" : [ {
                  "name" : "DateTimeText",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "path" : "effectiveDateTime",
                     "type" : "Property",
                     "source" : {
                        "name" : "o",
                        "type" : "OperandRef"
                     }
                  } ]
               }, {
                  "name" : "DateTimeText",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "path" : "start",
                     "type" : "Property",
                     "source" : {
                        "path" : "effectivePeriod",
                        "type" : "Property",
                        "source" : {
                           "name" : "o",
                           "type" : "OperandRef"
                        }
                     }
                  } ]
               }, {
                  "name" : "InstantText",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "path" : "issued",
                     "type" : "Property",
                     "source" : {
                        "name" : "o",
                        "type" : "OperandRef"
                     }
                  } ]
               } ]
            },
            "operand" : [ {
               "name" : "o",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Observation",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "MedicationStatementDate",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Coalesce",
               "operand" : [ {
                  "name" : "DateTimeText",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "path" : "effectiveDateTime",
                     "type" : "Property",
                     "source" : {
                        "name" : "s",
                        "type" : "OperandRef"
                     }
                  } ]
               }, {
                  "name" : "DateTimeText",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "path" : "start",
                     "type" : "Property",
                     "source" : {
                        "path" : "effectivePeriod",
                        "type" : "Property",
                        "source" : {
                           "name" : "s",
                           "type" : "OperandRef"
                        }
                     }
                  } ]
               } ]
            },
            "operand" : [ {
               "name" : "s",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}MedicationStatement",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "Onset",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Coalesce",
               "operand" : [ {
                  "type" : "List",
                  "element" : [ {
                     "name" : "DateTimeText",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "onsetDateTime",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "name" : "QuantityText",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "onsetQuantity",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "name" : "PeriodObject",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "onsetPeriod",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "name" : "RangeObject",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "onsetRange",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "onsetString",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     }
                  } ]
               } ]
            },
            "operand" : [ {
               "name" : "c",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Condition",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "Abatement",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Coalesce",
               "operand" : [ {
                  "type" : "List",
                  "element" : [ {
                     "name" : "DateTimeText",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "abatementDateTime",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "name" : "QuantityText",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "abatementQuantity",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "name" : "PeriodObject",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "abatementPeriod",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "name" : "RangeObject",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "path" : "abatementRange",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ]
                  }, {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "abatementString",
                        "type" : "Property",
                        "source" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     }
                  }, {
                     "type" : "ToString",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "path" : "abatementBoolean",
                           "type" : "Property",
                           "source" : {
                              "name" : "c",
                              "type" : "OperandRef"
                           }
                        }
                     }
                  } ]
               } ]
            },
            "operand" : [ {
               "name" : "c",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Condition",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "SortPegComponents",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Flatten",
               "operand" : {
                  "type" : "List",
                  "element" : [ {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "OC",
                        "expression" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToConcept",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "OC",
                              "type" : "Property"
                           } ]
                        }, {
                           "name" : "Pain",
                           "type" : "ConceptRef"
                        } ]
                     }
                  }, {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "OC",
                        "expression" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToConcept",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "OC",
                              "type" : "Property"
                           } ]
                        }, {
                           "name" : "Enjoyment of life",
                           "type" : "ConceptRef"
                        } ]
                     }
                  }, {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "OC",
                        "expression" : {
                           "name" : "c",
                           "type" : "OperandRef"
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToConcept",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "OC",
                              "type" : "Property"
                           } ]
                        }, {
                           "name" : "General activity",
                           "type" : "ConceptRef"
                        } ]
                     }
                  } ]
               }
            },
            "operand" : [ {
               "name" : "c",
               "operandTypeSpecifier" : {
                  "type" : "ListTypeSpecifier",
                  "elementType" : {
                     "name" : "{http://hl7.org/fhir}Observation.Component",
                     "type" : "NamedTypeSpecifier"
                  }
               }
            } ]
         }, {
            "name" : "Is18orOlder",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "GreaterOrEqual",
               "operand" : [ {
                  "precision" : "Year",
                  "type" : "CalculateAge",
                  "operand" : {
                     "path" : "birthDate.value",
                     "type" : "Property",
                     "source" : {
                        "name" : "Patient",
                        "type" : "ExpressionRef"
                     }
                  }
               }, {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "18",
                  "type" : "Literal"
               } ]
            }
         }, {
            "name" : "ConditionsAssociatedWithChronicPain",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ActiveOrRecurring",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Conditions associated with chronic pain",
                        "type" : "ValueSetRef"
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "HasConditionAssociatedWithChronicPain",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "ConditionsAssociatedWithChronicPain",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "HasRecentOpioidPainMedication",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "ActiveCompletedOrStoppedMedicationOrder",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "name" : "MedicationOrderLookBack",
                        "libraryName" : "C3F",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                           "codeProperty" : "medicationCodeableConcept",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Opioid Pain Medications",
                              "type" : "ValueSetRef"
                           }
                        }, {
                           "name" : "InclusionMedicationsLookbackPeriod",
                           "type" : "ParameterRef"
                        } ]
                     } ]
                  }
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "ActiveOrCompletedMedicationStatement",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "name" : "MedicationStatementLookBack",
                        "libraryName" : "C3F",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                           "codeProperty" : "medicationCodeableConcept",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Opioid Pain Medications",
                              "type" : "ValueSetRef"
                           }
                        }, {
                           "name" : "InclusionMedicationsLookbackPeriod",
                           "type" : "ParameterRef"
                        } ]
                     } ]
                  }
               } ]
            }
         }, {
            "name" : "HasRecentAdjuvantAnalgesicMedication",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "ActiveCompletedOrStoppedMedicationOrder",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "name" : "MedicationOrderLookBack",
                        "libraryName" : "C3F",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                           "codeProperty" : "medicationCodeableConcept",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Adjuvant Analgesic Medications",
                              "type" : "ValueSetRef"
                           }
                        }, {
                           "name" : "InclusionMedicationsLookbackPeriod",
                           "type" : "ParameterRef"
                        } ]
                     } ]
                  }
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "ActiveOrCompletedMedicationStatement",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "name" : "MedicationStatementLookBack",
                        "libraryName" : "C3F",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                           "codeProperty" : "medicationCodeableConcept",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Adjuvant Analgesic Medications",
                              "type" : "ValueSetRef"
                           }
                        }, {
                           "name" : "InclusionMedicationsLookbackPeriod",
                           "type" : "ParameterRef"
                        } ]
                     } ]
                  }
               } ]
            }
         }, {
            "name" : "MeetsInclusionCriteria",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "name" : "Is18orOlder",
                  "type" : "ExpressionRef"
               }, {
                  "type" : "Or",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "name" : "HasConditionAssociatedWithChronicPain",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "HasRecentOpioidPainMedication",
                        "type" : "ExpressionRef"
                     } ]
                  }, {
                     "name" : "HasRecentAdjuvantAnalgesicMedication",
                     "type" : "ExpressionRef"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportConditionsAssociatedWithChronicPain",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "C",
                  "expression" : {
                     "name" : "ConditionsAssociatedWithChronicPain",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "C",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "clinicalStatus",
                              "scope" : "C",
                              "type" : "Property"
                           }
                        }
                     }, {
                        "name" : "Onset",
                        "value" : {
                           "name" : "Onset",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "C",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "DateRecorded",
                        "value" : {
                           "name" : "DateText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateRecorded",
                              "scope" : "C",
                              "type" : "Property"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "type" : "ByExpression",
                     "expression" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "name" : "Onset",
                           "type" : "IdentifierRef"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  } ]
               }
            }
         }, {
            "name" : "DepressionConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ActiveOrRecurring",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Major Depression",
                        "type" : "ValueSetRef"
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "AnxietyConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ActiveOrRecurring",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Anxiety",
                        "type" : "ValueSetRef"
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "SubstanceUseDisorderConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "dataType" : "{http://hl7.org/fhir}Condition",
                  "codeProperty" : "code",
                  "type" : "Retrieve",
                  "codes" : {
                     "name" : "Substance use disorder",
                     "type" : "ValueSetRef"
                  }
               } ]
            }
         }, {
            "name" : "SuicideAttemptConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Union",
               "operand" : [ {
                  "name" : "Confirmed",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Suicide attempt",
                        "type" : "ValueSetRef"
                     }
                  } ]
               }, {
                  "name" : "Confirmed",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "type" : "ToList",
                        "operand" : {
                           "name" : "Suicidal deliberate poisoning",
                           "type" : "ConceptRef"
                        }
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "SleepDisorderedBreathingConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ActiveOrRecurring",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Sleep-disordered breathing",
                        "type" : "ValueSetRef"
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "RenalDysfunctionConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ActiveOrRecurring",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Condition",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Kidney Failure",
                        "type" : "ValueSetRef"
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "HepaticDysfunctionConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Union",
               "operand" : [ {
                  "name" : "Confirmed",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "name" : "ActiveOrRecurring",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "dataType" : "{http://hl7.org/fhir}Condition",
                        "codeProperty" : "code",
                        "type" : "Retrieve",
                        "codes" : {
                           "name" : "Chronic Liver Disease",
                           "type" : "ValueSetRef"
                        }
                     } ]
                  } ]
               }, {
                  "name" : "Confirmed",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "name" : "ActiveOrRecurring",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "dataType" : "{http://hl7.org/fhir}Condition",
                        "codeProperty" : "code",
                        "type" : "Retrieve",
                        "codes" : {
                           "name" : "Liver Disease",
                           "type" : "ValueSetRef"
                        }
                     } ]
                  } ]
               } ]
            }
         }, {
            "name" : "PregnancyConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Confirmed",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ConditionLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "name" : "ActiveOrRecurring",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "dataType" : "{http://hl7.org/fhir}Condition",
                        "codeProperty" : "code",
                        "type" : "Retrieve",
                        "codes" : {
                           "name" : "Pregnancy",
                           "type" : "ValueSetRef"
                        }
                     } ]
                  }, {
                     "value" : 42,
                     "unit" : "weeks",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "PregnancyObservations",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Verified",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ObservationLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "type" : "ToList",
                        "operand" : {
                           "name" : "Pregnancy status",
                           "type" : "ConceptRef"
                        }
                     }
                  }, {
                     "value" : 42,
                     "unit" : "weeks",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "MostRecentPregnancyObservation",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "MostRecent",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "PregnancyObservations",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "MostRecentPregnancyObservationIsPositive",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Equivalent",
               "operand" : [ {
                  "name" : "ConceptValue",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "name" : "MostRecentPregnancyObservation",
                     "type" : "ExpressionRef"
                  } ]
               }, {
                  "name" : "Pregnant",
                  "type" : "ConceptRef"
               } ]
            }
         }, {
            "name" : "Is65orOlder",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "GreaterOrEqual",
               "operand" : [ {
                  "precision" : "Year",
                  "type" : "CalculateAge",
                  "operand" : {
                     "path" : "birthDate.value",
                     "type" : "Property",
                     "source" : {
                        "name" : "Patient",
                        "type" : "ExpressionRef"
                     }
                  }
               }, {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "65",
                  "type" : "Literal"
               } ]
            }
         }, {
            "name" : "ConditionRiskFactorsForOpioidRelatedHarms",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Union",
               "operand" : [ {
                  "type" : "Union",
                  "operand" : [ {
                     "type" : "Union",
                     "operand" : [ {
                        "type" : "Union",
                        "operand" : [ {
                           "type" : "Union",
                           "operand" : [ {
                              "type" : "Union",
                              "operand" : [ {
                                 "type" : "Union",
                                 "operand" : [ {
                                    "name" : "DepressionConditions",
                                    "type" : "ExpressionRef"
                                 }, {
                                    "name" : "AnxietyConditions",
                                    "type" : "ExpressionRef"
                                 } ]
                              }, {
                                 "name" : "SubstanceUseDisorderConditions",
                                 "type" : "ExpressionRef"
                              } ]
                           }, {
                              "name" : "SuicideAttemptConditions",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "name" : "SleepDisorderedBreathingConditions",
                           "type" : "ExpressionRef"
                        } ]
                     }, {
                        "name" : "RenalDysfunctionConditions",
                        "type" : "ExpressionRef"
                     } ]
                  }, {
                     "name" : "HepaticDysfunctionConditions",
                     "type" : "ExpressionRef"
                  } ]
               }, {
                  "name" : "PregnancyConditions",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "EncounterRiskFactorsForOpioidRelatedHarms",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "E",
                  "expression" : {
                     "dataType" : "{http://hl7.org/fhir}Encounter",
                     "type" : "Retrieve"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Exists",
                  "operand" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "R",
                        "expression" : {
                           "path" : "reason",
                           "scope" : "E",
                           "type" : "Property"
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "Or",
                           "operand" : [ {
                              "type" : "Or",
                              "operand" : [ {
                                 "type" : "Or",
                                 "operand" : [ {
                                    "type" : "Or",
                                    "operand" : [ {
                                       "type" : "Or",
                                       "operand" : [ {
                                          "type" : "Or",
                                          "operand" : [ {
                                             "type" : "Or",
                                             "operand" : [ {
                                                "type" : "InValueSet",
                                                "code" : {
                                                   "name" : "NullSafeToConcept",
                                                   "libraryName" : "C3F",
                                                   "type" : "FunctionRef",
                                                   "operand" : [ {
                                                      "name" : "R",
                                                      "type" : "AliasRef"
                                                   } ]
                                                },
                                                "valueset" : {
                                                   "name" : "Major Depression"
                                                }
                                             }, {
                                                "type" : "InValueSet",
                                                "code" : {
                                                   "name" : "NullSafeToConcept",
                                                   "libraryName" : "C3F",
                                                   "type" : "FunctionRef",
                                                   "operand" : [ {
                                                      "name" : "R",
                                                      "type" : "AliasRef"
                                                   } ]
                                                },
                                                "valueset" : {
                                                   "name" : "Anxiety"
                                                }
                                             } ]
                                          }, {
                                             "type" : "InValueSet",
                                             "code" : {
                                                "name" : "NullSafeToConcept",
                                                "libraryName" : "C3F",
                                                "type" : "FunctionRef",
                                                "operand" : [ {
                                                   "name" : "R",
                                                   "type" : "AliasRef"
                                                } ]
                                             },
                                             "valueset" : {
                                                "name" : "Substance use disorder"
                                             }
                                          } ]
                                       }, {
                                          "type" : "InValueSet",
                                          "code" : {
                                             "name" : "NullSafeToConcept",
                                             "libraryName" : "C3F",
                                             "type" : "FunctionRef",
                                             "operand" : [ {
                                                "name" : "R",
                                                "type" : "AliasRef"
                                             } ]
                                          },
                                          "valueset" : {
                                             "name" : "Suicide attempt"
                                          }
                                       } ]
                                    }, {
                                       "type" : "Equivalent",
                                       "operand" : [ {
                                          "name" : "NullSafeToConcept",
                                          "libraryName" : "C3F",
                                          "type" : "FunctionRef",
                                          "operand" : [ {
                                             "name" : "R",
                                             "type" : "AliasRef"
                                          } ]
                                       }, {
                                          "name" : "Suicidal deliberate poisoning",
                                          "type" : "ConceptRef"
                                       } ]
                                    } ]
                                 }, {
                                    "type" : "InValueSet",
                                    "code" : {
                                       "name" : "NullSafeToConcept",
                                       "libraryName" : "C3F",
                                       "type" : "FunctionRef",
                                       "operand" : [ {
                                          "name" : "R",
                                          "type" : "AliasRef"
                                       } ]
                                    },
                                    "valueset" : {
                                       "name" : "Sleep-disordered breathing"
                                    }
                                 } ]
                              }, {
                                 "type" : "InValueSet",
                                 "code" : {
                                    "name" : "NullSafeToConcept",
                                    "libraryName" : "C3F",
                                    "type" : "FunctionRef",
                                    "operand" : [ {
                                       "name" : "R",
                                       "type" : "AliasRef"
                                    } ]
                                 },
                                 "valueset" : {
                                    "name" : "Kidney Failure"
                                 }
                              } ]
                           }, {
                              "type" : "InValueSet",
                              "code" : {
                                 "name" : "NullSafeToConcept",
                                 "libraryName" : "C3F",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "name" : "R",
                                    "type" : "AliasRef"
                                 } ]
                              },
                              "valueset" : {
                                 "name" : "Chronic Liver Disease"
                              }
                           } ]
                        }, {
                           "type" : "InValueSet",
                           "code" : {
                              "name" : "NullSafeToConcept",
                              "libraryName" : "C3F",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "name" : "R",
                                 "type" : "AliasRef"
                              } ]
                           },
                           "valueset" : {
                              "name" : "Liver Disease"
                           }
                        } ]
                     }
                  }
               }
            }
         }, {
            "name" : "ReportConditionRiskFactorsForOpioidRelatedHarms",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "C",
                  "expression" : {
                     "name" : "ConditionRiskFactorsForOpioidRelatedHarms",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "C",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "clinicalStatus",
                              "scope" : "C",
                              "type" : "Property"
                           }
                        }
                     }, {
                        "name" : "Onset",
                        "value" : {
                           "name" : "Onset",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "C",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "DateRecorded",
                        "value" : {
                           "name" : "DateText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateRecorded",
                              "scope" : "C",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Abatement",
                        "value" : {
                           "name" : "Abatement",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "C",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "Visit",
                        "value" : {
                           "strict" : false,
                           "type" : "As",
                           "operand" : {
                              "type" : "Null"
                           },
                           "asTypeSpecifier" : {
                              "type" : "TupleTypeSpecifier",
                              "element" : [ {
                                 "name" : "Start",
                                 "type" : {
                                    "name" : "{urn:hl7-org:elm-types:r1}String",
                                    "type" : "NamedTypeSpecifier"
                                 }
                              }, {
                                 "name" : "End",
                                 "type" : {
                                    "name" : "{urn:hl7-org:elm-types:r1}String",
                                    "type" : "NamedTypeSpecifier"
                                 }
                              } ]
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "type" : "ByExpression",
                     "expression" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "name" : "Onset",
                           "type" : "IdentifierRef"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  }, {
                     "direction" : "desc",
                     "type" : "ByExpression",
                     "expression" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "name" : "Abatement",
                           "type" : "IdentifierRef"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  } ]
               }
            }
         }, {
            "name" : "GetEncounterDiagnosesRiskFactorsForOpioidRelatedHarms",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "path" : "reason",
                     "type" : "Property",
                     "source" : {
                        "name" : "enc",
                        "type" : "OperandRef"
                     }
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Or",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "Or",
                           "operand" : [ {
                              "type" : "Or",
                              "operand" : [ {
                                 "type" : "Or",
                                 "operand" : [ {
                                    "type" : "Or",
                                    "operand" : [ {
                                       "type" : "Or",
                                       "operand" : [ {
                                          "type" : "InValueSet",
                                          "code" : {
                                             "name" : "NullSafeToConcept",
                                             "libraryName" : "C3F",
                                             "type" : "FunctionRef",
                                             "operand" : [ {
                                                "name" : "R",
                                                "type" : "AliasRef"
                                             } ]
                                          },
                                          "valueset" : {
                                             "name" : "Major Depression"
                                          }
                                       }, {
                                          "type" : "InValueSet",
                                          "code" : {
                                             "name" : "NullSafeToConcept",
                                             "libraryName" : "C3F",
                                             "type" : "FunctionRef",
                                             "operand" : [ {
                                                "name" : "R",
                                                "type" : "AliasRef"
                                             } ]
                                          },
                                          "valueset" : {
                                             "name" : "Anxiety"
                                          }
                                       } ]
                                    }, {
                                       "type" : "InValueSet",
                                       "code" : {
                                          "name" : "NullSafeToConcept",
                                          "libraryName" : "C3F",
                                          "type" : "FunctionRef",
                                          "operand" : [ {
                                             "name" : "R",
                                             "type" : "AliasRef"
                                          } ]
                                       },
                                       "valueset" : {
                                          "name" : "Substance use disorder"
                                       }
                                    } ]
                                 }, {
                                    "type" : "InValueSet",
                                    "code" : {
                                       "name" : "NullSafeToConcept",
                                       "libraryName" : "C3F",
                                       "type" : "FunctionRef",
                                       "operand" : [ {
                                          "name" : "R",
                                          "type" : "AliasRef"
                                       } ]
                                    },
                                    "valueset" : {
                                       "name" : "Suicide attempt"
                                    }
                                 } ]
                              }, {
                                 "type" : "Equivalent",
                                 "operand" : [ {
                                    "name" : "NullSafeToConcept",
                                    "libraryName" : "C3F",
                                    "type" : "FunctionRef",
                                    "operand" : [ {
                                       "name" : "R",
                                       "type" : "AliasRef"
                                    } ]
                                 }, {
                                    "name" : "Suicidal deliberate poisoning",
                                    "type" : "ConceptRef"
                                 } ]
                              } ]
                           }, {
                              "type" : "InValueSet",
                              "code" : {
                                 "name" : "NullSafeToConcept",
                                 "libraryName" : "C3F",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "name" : "R",
                                    "type" : "AliasRef"
                                 } ]
                              },
                              "valueset" : {
                                 "name" : "Sleep-disordered breathing"
                              }
                           } ]
                        }, {
                           "type" : "InValueSet",
                           "code" : {
                              "name" : "NullSafeToConcept",
                              "libraryName" : "C3F",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "name" : "R",
                                 "type" : "AliasRef"
                              } ]
                           },
                           "valueset" : {
                              "name" : "Kidney Failure"
                           }
                        } ]
                     }, {
                        "type" : "InValueSet",
                        "code" : {
                           "name" : "NullSafeToConcept",
                           "libraryName" : "C3F",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "R",
                              "type" : "AliasRef"
                           } ]
                        },
                        "valueset" : {
                           "name" : "Chronic Liver Disease"
                        }
                     } ]
                  }, {
                     "type" : "InValueSet",
                     "code" : {
                        "name" : "NullSafeToConcept",
                        "libraryName" : "C3F",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "name" : "R",
                           "type" : "AliasRef"
                        } ]
                     },
                     "valueset" : {
                        "name" : "Liver Disease"
                     }
                  } ]
               },
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "R",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "strict" : false,
                           "type" : "As",
                           "operand" : {
                              "type" : "Null"
                           },
                           "asTypeSpecifier" : {
                              "name" : "{urn:hl7-org:elm-types:r1}String",
                              "type" : "NamedTypeSpecifier"
                           }
                        }
                     }, {
                        "name" : "Onset",
                        "value" : {
                           "strict" : false,
                           "type" : "As",
                           "operand" : {
                              "type" : "Null"
                           },
                           "asTypeSpecifier" : {
                              "name" : "{urn:hl7-org:elm-types:r1}String",
                              "type" : "NamedTypeSpecifier"
                           }
                        }
                     }, {
                        "name" : "DateRecorded",
                        "value" : {
                           "strict" : false,
                           "type" : "As",
                           "operand" : {
                              "type" : "Null"
                           },
                           "asTypeSpecifier" : {
                              "name" : "{urn:hl7-org:elm-types:r1}String",
                              "type" : "NamedTypeSpecifier"
                           }
                        }
                     }, {
                        "name" : "Abatement",
                        "value" : {
                           "strict" : false,
                           "type" : "As",
                           "operand" : {
                              "type" : "Null"
                           },
                           "asTypeSpecifier" : {
                              "name" : "{urn:hl7-org:elm-types:r1}String",
                              "type" : "NamedTypeSpecifier"
                           }
                        }
                     }, {
                        "name" : "Visit",
                        "value" : {
                           "name" : "PeriodObject",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "period",
                              "type" : "Property",
                              "source" : {
                                 "name" : "enc",
                                 "type" : "OperandRef"
                              }
                           } ]
                        }
                     } ]
                  }
               }
            },
            "operand" : [ {
               "name" : "enc",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Encounter",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "ReportEncounterRiskFactorsForOpioidRelatedHarms",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "D",
                  "expression" : {
                     "type" : "Flatten",
                     "operand" : {
                        "type" : "Query",
                        "source" : [ {
                           "alias" : "E",
                           "expression" : {
                              "name" : "EncounterRiskFactorsForOpioidRelatedHarms",
                              "type" : "ExpressionRef"
                           }
                        } ],
                        "relationship" : [ ],
                        "return" : {
                           "expression" : {
                              "name" : "GetEncounterDiagnosesRiskFactorsForOpioidRelatedHarms",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "name" : "E",
                                 "type" : "AliasRef"
                              } ]
                           }
                        }
                     }
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "type" : "ByExpression",
                     "expression" : {
                        "path" : "Start",
                        "type" : "Property",
                        "source" : {
                           "name" : "Visit",
                           "type" : "IdentifierRef"
                        }
                     }
                  }, {
                     "direction" : "desc",
                     "type" : "ByExpression",
                     "expression" : {
                        "path" : "End",
                        "type" : "Property",
                        "source" : {
                           "name" : "Visit",
                           "type" : "IdentifierRef"
                        }
                     }
                  } ]
               }
            }
         }, {
            "name" : "ReportMostRecentPositivePregnancyObservation",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "name" : "MostRecentPregnancyObservationIsPositive",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "Tuple",
                  "element" : [ {
                     "name" : "Name",
                     "value" : {
                        "name" : "ConceptText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "MostRecentPregnancyObservation",
                              "type" : "ExpressionRef"
                           }
                        } ]
                     }
                  }, {
                     "name" : "Status",
                     "value" : {
                        "name" : "ConceptText",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "valueCodeableConcept",
                           "type" : "Property",
                           "source" : {
                              "name" : "MostRecentPregnancyObservation",
                              "type" : "ExpressionRef"
                           }
                        } ]
                     }
                  }, {
                     "name" : "Onset",
                     "value" : {
                        "type" : "ToString",
                        "operand" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "effectiveDateTime",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "MostRecentPregnancyObservation",
                                    "type" : "ExpressionRef"
                                 }
                              }
                           }, {
                              "name" : "ToDateTime",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "start",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "effectivePeriod",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "MostRecentPregnancyObservation",
                                       "type" : "ExpressionRef"
                                    }
                                 }
                              } ]
                           } ]
                        }
                     }
                  }, {
                     "name" : "DateRecorded",
                     "value" : {
                        "type" : "ToString",
                        "operand" : {
                           "name" : "ToDateTime",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "issued",
                              "type" : "Property",
                              "source" : {
                                 "name" : "MostRecentPregnancyObservation",
                                 "type" : "ExpressionRef"
                              }
                           } ]
                        }
                     }
                  }, {
                     "name" : "Abatement",
                     "value" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "type" : "Null"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  }, {
                     "name" : "Visit",
                     "value" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "type" : "Null"
                        },
                        "asTypeSpecifier" : {
                           "type" : "TupleTypeSpecifier",
                           "element" : [ {
                              "name" : "Start",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           }, {
                              "name" : "End",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           } ]
                        }
                     }
                  } ]
               },
               "else" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  },
                  "asTypeSpecifier" : {
                     "type" : "TupleTypeSpecifier",
                     "element" : [ {
                        "name" : "Name",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Status",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Onset",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "DateRecorded",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Abatement",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Visit",
                        "type" : {
                           "type" : "TupleTypeSpecifier",
                           "element" : [ {
                              "name" : "Start",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           }, {
                              "name" : "End",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           } ]
                        }
                     } ]
                  }
               }
            }
         }, {
            "name" : "ReportOlderThan65",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "name" : "Is65orOlder",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "Tuple",
                  "element" : [ {
                     "name" : "Name",
                     "value" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "65 years or older",
                        "type" : "Literal"
                     }
                  }, {
                     "name" : "Status",
                     "value" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "active",
                        "type" : "Literal"
                     }
                  }, {
                     "name" : "Onset",
                     "value" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "type" : "Null"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  }, {
                     "name" : "DateRecorded",
                     "value" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "type" : "Null"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  }, {
                     "name" : "Abatement",
                     "value" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "type" : "Null"
                        },
                        "asTypeSpecifier" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }
                  }, {
                     "name" : "Visit",
                     "value" : {
                        "strict" : false,
                        "type" : "As",
                        "operand" : {
                           "type" : "Null"
                        },
                        "asTypeSpecifier" : {
                           "type" : "TupleTypeSpecifier",
                           "element" : [ {
                              "name" : "Start",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           }, {
                              "name" : "End",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           } ]
                        }
                     }
                  } ]
               },
               "else" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  },
                  "asTypeSpecifier" : {
                     "type" : "TupleTypeSpecifier",
                     "element" : [ {
                        "name" : "Name",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Status",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Onset",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "DateRecorded",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Abatement",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Visit",
                        "type" : {
                           "type" : "TupleTypeSpecifier",
                           "element" : [ {
                              "name" : "Start",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           }, {
                              "name" : "End",
                              "type" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           } ]
                        }
                     } ]
                  }
               }
            }
         }, {
            "name" : "ReportRiskFactorsForOpioidRelatedHarms",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "type" : "Exists",
                     "operand" : {
                        "name" : "PregnancyConditions",
                        "type" : "ExpressionRef"
                     }
                  }
               },
               "then" : {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "C",
                     "expression" : {
                        "type" : "Union",
                        "operand" : [ {
                           "type" : "Union",
                           "operand" : [ {
                              "name" : "ReportConditionRiskFactorsForOpioidRelatedHarms",
                              "type" : "ExpressionRef"
                           }, {
                              "name" : "ReportEncounterRiskFactorsForOpioidRelatedHarms",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "type" : "ToList",
                           "operand" : {
                              "name" : "ReportOlderThan65",
                              "type" : "ExpressionRef"
                           }
                        } ]
                     }
                  } ],
                  "relationship" : [ ]
               },
               "else" : {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "C",
                     "expression" : {
                        "type" : "Union",
                        "operand" : [ {
                           "type" : "Union",
                           "operand" : [ {
                              "type" : "Union",
                              "operand" : [ {
                                 "name" : "ReportConditionRiskFactorsForOpioidRelatedHarms",
                                 "type" : "ExpressionRef"
                              }, {
                                 "name" : "ReportEncounterRiskFactorsForOpioidRelatedHarms",
                                 "type" : "ExpressionRef"
                              } ]
                           }, {
                              "type" : "ToList",
                              "operand" : {
                                 "name" : "ReportOlderThan65",
                                 "type" : "ExpressionRef"
                              }
                           } ]
                        }, {
                           "type" : "ToList",
                           "operand" : {
                              "name" : "ReportMostRecentPositivePregnancyObservation",
                              "type" : "ExpressionRef"
                           }
                        } ]
                     }
                  } ],
                  "relationship" : [ ],
                  "sort" : {
                     "by" : [ {
                        "direction" : "desc",
                        "type" : "ByExpression",
                        "expression" : {
                           "type" : "If",
                           "condition" : {
                              "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                              "type" : "As",
                              "operand" : {
                                 "type" : "Not",
                                 "operand" : {
                                    "type" : "IsNull",
                                    "operand" : {
                                       "name" : "Onset",
                                       "type" : "IdentifierRef"
                                    }
                                 }
                              }
                           },
                           "then" : {
                              "strict" : false,
                              "type" : "As",
                              "operand" : {
                                 "name" : "Onset",
                                 "type" : "IdentifierRef"
                              },
                              "asTypeSpecifier" : {
                                 "name" : "{urn:hl7-org:elm-types:r1}String",
                                 "type" : "NamedTypeSpecifier"
                              }
                           },
                           "else" : {
                              "path" : "Start",
                              "type" : "Property",
                              "source" : {
                                 "name" : "Visit",
                                 "type" : "IdentifierRef"
                              }
                           }
                        }
                     }, {
                        "direction" : "desc",
                        "type" : "ByExpression",
                        "expression" : {
                           "path" : "End",
                           "type" : "Property",
                           "source" : {
                              "name" : "Visit",
                              "type" : "IdentifierRef"
                           }
                        }
                     }, {
                        "direction" : "desc",
                        "type" : "ByExpression",
                        "expression" : {
                           "strict" : false,
                           "type" : "As",
                           "operand" : {
                              "name" : "Abatement",
                              "type" : "IdentifierRef"
                           },
                           "asTypeSpecifier" : {
                              "name" : "{urn:hl7-org:elm-types:r1}String",
                              "type" : "NamedTypeSpecifier"
                           }
                        }
                     } ]
                  }
               }
            }
         }, {
            "name" : "NumericPainIntensityAssessments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Verified",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ObservationLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "type" : "ToList",
                        "operand" : {
                           "name" : "Pain severity Wong-Baker FACES Scale",
                           "type" : "ConceptRef"
                        }
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportNumericPainIntensityAssessments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "A",
                  "expression" : {
                     "name" : "NumericPainIntensityAssessments",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptTextWithRange",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Score",
                        "value" : {
                           "name" : "QuantityText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "valueQuantity",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Interpretation",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "interpretation",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueCodeableConcept",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "ObservationDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "A",
                              "type" : "AliasRef"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "PainEnjoymentGeneralActivityAssessments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Verified",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ObservationLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "type" : "ToList",
                        "operand" : {
                           "name" : "Pain Enjoyment General Activity (PEG) Assessment",
                           "type" : "ConceptRef"
                        }
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportPainEnjoymentGeneralActivityAssessments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "A",
                  "expression" : {
                     "name" : "PainEnjoymentGeneralActivityAssessments",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptTextWithRange",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Score",
                        "value" : {
                           "name" : "QuantityText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "valueQuantity",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Interpretation",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "interpretation",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueCodeableConcept",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           } ]
                        }
                     }, {
                        "name" : "Questions",
                        "value" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "C",
                              "expression" : {
                                 "name" : "SortPegComponents",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "path" : "component",
                                    "scope" : "A",
                                    "type" : "Property"
                                 } ]
                              }
                           } ],
                           "relationship" : [ ],
                           "return" : {
                              "expression" : {
                                 "type" : "Tuple",
                                 "element" : [ {
                                    "name" : "Name",
                                    "value" : {
                                       "name" : "ConceptText",
                                       "type" : "FunctionRef",
                                       "operand" : [ {
                                          "path" : "code",
                                          "scope" : "C",
                                          "type" : "Property"
                                       } ]
                                    }
                                 }, {
                                    "name" : "Score",
                                    "value" : {
                                       "name" : "QuantityText",
                                       "type" : "FunctionRef",
                                       "operand" : [ {
                                          "path" : "valueQuantity",
                                          "scope" : "C",
                                          "type" : "Property"
                                       } ]
                                    }
                                 } ]
                              }
                           }
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "ObservationDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "A",
                              "type" : "AliasRef"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "STarTBackAssessments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Verified",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ObservationLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "type" : "ToList",
                        "operand" : {
                           "name" : "STarT Back Screening Tool",
                           "type" : "ConceptRef"
                        }
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportSTarTBackAssessments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "A",
                  "expression" : {
                     "name" : "STarTBackAssessments",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptTextWithRange",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Score",
                        "value" : {
                           "name" : "QuantityText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "valueQuantity",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Interpretation",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "interpretation",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueCodeableConcept",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "ObservationDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "A",
                              "type" : "AliasRef"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "OpioidMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveCompletedOrStoppedMedicationOrder",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationOrderLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Opioid Pain Medications",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "OpioidMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveOrCompletedMedicationStatement",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationStatementLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Opioid Pain Medications",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportOpioidMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "O",
                  "expression" : {
                     "name" : "OpioidMedicationOrders",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Order",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateWritten",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateEnded",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "O",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportOpioidMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "OpioidMedicationStatements",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Statement",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "MedicationStatementDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "end",
                              "type" : "Property",
                              "source" : {
                                 "path" : "effectivePeriod",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "S",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportOpioidMedications",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "M",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "name" : "ReportOpioidMedicationOrders",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "ReportOpioidMedicationStatements",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "NonOpioidMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveCompletedOrStoppedMedicationOrder",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationOrderLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Non opiod pain medications",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "NonOpioidMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveOrCompletedMedicationStatement",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationStatementLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Non opiod pain medications",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportNonOpioidMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "O",
                  "expression" : {
                     "name" : "NonOpioidMedicationOrders",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Order",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateWritten",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateEnded",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "O",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportNonOpioidMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "NonOpioidMedicationStatements",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Statement",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "MedicationStatementDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "end",
                              "type" : "Property",
                              "source" : {
                                 "path" : "effectivePeriod",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "S",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportNonOpioidMedications",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "M",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "name" : "ReportNonOpioidMedicationOrders",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "ReportNonOpioidMedicationStatements",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "NonPharmacologicTreatmentProcedures",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ProcedurePerformance",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ProcedureLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Procedure",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Non pharmacologic treatments for chronic pain",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportNonPharmacologicTreatmentProcedures",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "P",
                  "expression" : {
                     "name" : "NonPharmacologicTreatmentProcedures",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Procedure",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "P",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "DateTimeText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "performedDateTime",
                                 "scope" : "P",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "DateTimeText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "start",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "performedPeriod",
                                    "scope" : "P",
                                    "type" : "Property"
                                 }
                              } ]
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "NonPharmacologicTreatmentProcedureRequests",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ProcedureRequestAcceptedOrInProgressOrCompleted",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ProcedureRequestLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}ProcedureRequest",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Non pharmacologic treatments for chronic pain",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportNonPharmacologicTreatmentProcedureRequests",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "P",
                  "expression" : {
                     "name" : "NonPharmacologicTreatmentProcedureRequests",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "ProcedureRequest",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "P",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "orderedOn",
                              "scope" : "P",
                              "type" : "Property"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "NonPharmacologicTreatmentReferralRequests",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ReferralRequestAcceptedOrActiveOrCompleted",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ReferralRequestLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "R",
                        "expression" : {
                           "dataType" : "{http://hl7.org/fhir}ReferralRequest",
                           "type" : "Retrieve"
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "Exists",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "SR",
                              "expression" : {
                                 "path" : "serviceRequested",
                                 "scope" : "R",
                                 "type" : "Property"
                              }
                           } ],
                           "relationship" : [ ],
                           "where" : {
                              "type" : "InValueSet",
                              "code" : {
                                 "name" : "ToConcept",
                                 "libraryName" : "FHIRHelpers",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "name" : "SR",
                                    "type" : "AliasRef"
                                 } ]
                              },
                              "valueset" : {
                                 "name" : "Non pharmacologic treatments for chronic pain"
                              }
                           }
                        }
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportNonPharmacologicTreatmentReferralRequests",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "P",
                  "expression" : {
                     "name" : "NonPharmacologicTreatmentReferralRequests",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Referral",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "type" : "Query",
                              "source" : [ {
                                 "alias" : "SR",
                                 "expression" : {
                                    "path" : "serviceRequested",
                                    "scope" : "P",
                                    "type" : "Property"
                                 }
                              } ],
                              "relationship" : [ ],
                              "return" : {
                                 "expression" : {
                                    "name" : "ConceptText",
                                    "type" : "FunctionRef",
                                    "operand" : [ {
                                       "name" : "SR",
                                       "type" : "AliasRef"
                                    } ]
                                 }
                              }
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateSent",
                              "scope" : "P",
                              "type" : "Property"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportNonPharmacologicTreatments",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "M",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "type" : "Union",
                        "operand" : [ {
                           "name" : "ReportNonPharmacologicTreatmentProcedures",
                           "type" : "ExpressionRef"
                        }, {
                           "name" : "ReportNonPharmacologicTreatmentProcedureRequests",
                           "type" : "ExpressionRef"
                        } ]
                     }, {
                        "name" : "ReportNonPharmacologicTreatmentReferralRequests",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "StoolSoftenersAndLaxativesOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveCompletedOrStoppedMedicationOrder",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationOrderLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Stool softeners and laxatives",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 6,
                     "unit" : "months",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "StoolSoftenersAndLaxativesStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveOrCompletedMedicationStatement",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationStatementLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Stool softeners and laxatives",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 6,
                     "unit" : "months",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportStoolSoftenersAndLaxativesOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "O",
                  "expression" : {
                     "name" : "StoolSoftenersAndLaxativesOrders",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Order",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateWritten",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateEnded",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "O",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportStoolSoftenersAndLaxativesStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "StoolSoftenersAndLaxativesStatements",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Statement",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "MedicationStatementDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "end",
                              "type" : "Property",
                              "source" : {
                                 "path" : "effectivePeriod",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "S",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportStoolSoftenersAndLaxatives",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "M",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "name" : "ReportStoolSoftenersAndLaxativesOrders",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "ReportStoolSoftenersAndLaxativesStatements",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "MostRecentMME",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "MostRecent",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "Verified",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "name" : "ObservationLookBack",
                     "libraryName" : "C3F",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "dataType" : "{http://hl7.org/fhir}Observation",
                        "codeProperty" : "code",
                        "type" : "Retrieve",
                        "codes" : {
                           "type" : "ToList",
                           "operand" : {
                              "name" : "Morphine Milligram Equivalent (MME)",
                              "type" : "ConceptRef"
                           }
                        }
                     }, {
                        "value" : 6,
                        "unit" : "months",
                        "type" : "Quantity"
                     } ]
                  } ]
               } ]
            }
         }, {
            "name" : "ReportMostRecentMME",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "asType" : "{urn:hl7-org:elm-types:r1}Boolean",
                  "type" : "As",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "name" : "MostRecentMME",
                        "type" : "ExpressionRef"
                     }
                  }
               },
               "then" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  },
                  "asTypeSpecifier" : {
                     "type" : "TupleTypeSpecifier",
                     "element" : [ {
                        "name" : "Name",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Result",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     }, {
                        "name" : "Date",
                        "type" : {
                           "name" : "{urn:hl7-org:elm-types:r1}String",
                           "type" : "NamedTypeSpecifier"
                        }
                     } ]
                  }
               },
               "else" : {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "M",
                     "expression" : {
                        "name" : "MostRecentMME",
                        "type" : "ExpressionRef"
                     }
                  } ],
                  "relationship" : [ ],
                  "return" : {
                     "expression" : {
                        "type" : "Tuple",
                        "element" : [ {
                           "name" : "Name",
                           "value" : {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "code",
                                 "scope" : "M",
                                 "type" : "Property"
                              } ]
                           }
                        }, {
                           "name" : "Result",
                           "value" : {
                              "name" : "QuantityText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueQuantity",
                                 "scope" : "M",
                                 "type" : "Property"
                              } ]
                           }
                        }, {
                           "name" : "Date",
                           "value" : {
                              "name" : "ObservationDate",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "name" : "M",
                                 "type" : "AliasRef"
                              } ]
                           }
                        } ]
                     }
                  }
               }
            }
         }, {
            "name" : "UrineDrugScreens",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Verified",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ObservationLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "codeProperty" : "code",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Urine drug screen for pain management",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 1,
                     "unit" : "year",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportUrineDrugScreens",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "UrineDrugScreens",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Result",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "QuantityText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueQuantity",
                                 "scope" : "S",
                                 "type" : "Property"
                              } ]
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "valueString",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           }, {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueCodeableConcept",
                                 "scope" : "S",
                                 "type" : "Property"
                              } ]
                           } ]
                        }
                     }, {
                        "name" : "Interpretation",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "type" : "ToList",
                              "operand" : {
                                 "name" : "ConceptText",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "path" : "interpretation",
                                    "scope" : "S",
                                    "type" : "Property"
                                 } ]
                              }
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "ObservationDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "BenzodiazepineMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveCompletedOrStoppedMedicationOrder",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationOrderLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Benzodiazepine medications",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "BenzodiazepineMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveOrCompletedMedicationStatement",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "MedicationStatementLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                     "codeProperty" : "medicationCodeableConcept",
                     "type" : "Retrieve",
                     "codes" : {
                        "name" : "Benzodiazepine medications",
                        "type" : "ValueSetRef"
                     }
                  }, {
                     "value" : 2,
                     "unit" : "years",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportBenzodiazepineMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "O",
                  "expression" : {
                     "name" : "BenzodiazepineMedicationOrders",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Order",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateWritten",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateEnded",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "O",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportBenzodiazepineMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "BenzodiazepineMedicationStatements",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Statement",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "MedicationStatementDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "end",
                              "type" : "Property",
                              "source" : {
                                 "path" : "effectivePeriod",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "S",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportBenzodiazepineMedications",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "M",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "name" : "ReportBenzodiazepineMedicationOrders",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "ReportBenzodiazepineMedicationStatements",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "NaloxoneMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveCompletedOrStoppedMedicationOrder",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "dataType" : "{http://hl7.org/fhir}MedicationOrder",
                  "codeProperty" : "medicationCodeableConcept",
                  "type" : "Retrieve",
                  "codes" : {
                     "name" : "Naloxone medications",
                     "type" : "ValueSetRef"
                  }
               } ]
            }
         }, {
            "name" : "NaloxoneMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "ActiveOrCompletedMedicationStatement",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "dataType" : "{http://hl7.org/fhir}MedicationStatement",
                  "codeProperty" : "medicationCodeableConcept",
                  "type" : "Retrieve",
                  "codes" : {
                     "name" : "Naloxone medications",
                     "type" : "ValueSetRef"
                  }
               } ]
            }
         }, {
            "name" : "ReportNaloxoneMedicationOrders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "O",
                  "expression" : {
                     "name" : "NaloxoneMedicationOrders",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Order",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateWritten",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "dateEnded",
                              "scope" : "O",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "O",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportNaloxoneMedicationStatements",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "NaloxoneMedicationStatements",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Type",
                        "value" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "Statement",
                           "type" : "Literal"
                        }
                     }, {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "medicationCodeableConcept",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Start",
                        "value" : {
                           "name" : "MedicationStatementDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     }, {
                        "name" : "End",
                        "value" : {
                           "name" : "DateTimeText",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "end",
                              "type" : "Property",
                              "source" : {
                                 "path" : "effectivePeriod",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Status",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "S",
                              "type" : "Property"
                           }
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "ReportNaloxoneMedications",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "M",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "name" : "ReportNaloxoneMedicationOrders",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "ReportNaloxoneMedicationStatements",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Start",
                     "type" : "ByColumn"
                  }, {
                     "direction" : "desc",
                     "path" : "End",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "RiskScreeningsRelevantToPainManagement",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "Verified",
               "libraryName" : "C3F",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "ObservationLookBack",
                  "libraryName" : "C3F",
                  "type" : "FunctionRef",
                  "operand" : [ {
                     "type" : "Union",
                     "operand" : [ {
                        "type" : "Union",
                        "operand" : [ {
                           "dataType" : "{http://hl7.org/fhir}Observation",
                           "codeProperty" : "code",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Risk assessments relevant to pain management",
                              "type" : "ValueSetRef"
                           }
                        }, {
                           "dataType" : "{http://hl7.org/fhir}Observation",
                           "codeProperty" : "code",
                           "type" : "Retrieve",
                           "codes" : {
                              "type" : "ToList",
                              "operand" : {
                                 "name" : "Single question r/t ETOH use",
                                 "type" : "ConceptRef"
                              }
                           }
                        } ]
                     }, {
                        "dataType" : "{http://hl7.org/fhir}Observation",
                        "codeProperty" : "code",
                        "type" : "Retrieve",
                        "codes" : {
                           "type" : "ToList",
                           "operand" : {
                              "name" : "Single question r/t drug use",
                              "type" : "ConceptRef"
                           }
                        }
                     } ]
                  }, {
                     "value" : 1,
                     "unit" : "year",
                     "type" : "Quantity"
                  } ]
               } ]
            }
         }, {
            "name" : "ReportRiskScreeningsRelevantToPainManagement",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "name" : "RiskScreeningsRelevantToPainManagement",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "name" : "ConceptTextWithRange",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "code",
                              "scope" : "S",
                              "type" : "Property"
                           } ]
                        }
                     }, {
                        "name" : "Score",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "QuantityText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueQuantity",
                                 "scope" : "S",
                                 "type" : "Property"
                              } ]
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "valueString",
                                 "scope" : "S",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Interpretation",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "interpretation",
                                 "scope" : "S",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "ConceptText",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "valueCodeableConcept",
                                 "scope" : "S",
                                 "type" : "Property"
                              } ]
                           } ]
                        }
                     }, {
                        "name" : "Date",
                        "value" : {
                           "name" : "ObservationDate",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "name" : "S",
                              "type" : "AliasRef"
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "Date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "Summary",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Tuple",
               "element" : [ {
                  "name" : "Patient",
                  "value" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "Name",
                        "value" : {
                           "type" : "Concatenate",
                           "operand" : [ {
                              "type" : "Concatenate",
                              "operand" : [ {
                                 "type" : "Combine",
                                 "source" : {
                                    "type" : "Query",
                                    "source" : [ {
                                       "alias" : "G",
                                       "expression" : {
                                          "type" : "Flatten",
                                          "operand" : {
                                             "type" : "Query",
                                             "source" : [ {
                                                "alias" : "$this",
                                                "expression" : {
                                                   "path" : "name",
                                                   "type" : "Property",
                                                   "source" : {
                                                      "name" : "Patient",
                                                      "type" : "ExpressionRef"
                                                   }
                                                }
                                             } ],
                                             "where" : {
                                                "type" : "Not",
                                                "operand" : {
                                                   "type" : "IsNull",
                                                   "operand" : {
                                                      "path" : "given",
                                                      "type" : "Property",
                                                      "source" : {
                                                         "name" : "$this",
                                                         "type" : "AliasRef"
                                                      }
                                                   }
                                                }
                                             },
                                             "return" : {
                                                "expression" : {
                                                   "path" : "given",
                                                   "type" : "Property",
                                                   "source" : {
                                                      "name" : "$this",
                                                      "type" : "AliasRef"
                                                   }
                                                }
                                             }
                                          }
                                       }
                                    } ],
                                    "relationship" : [ ],
                                    "return" : {
                                       "expression" : {
                                          "path" : "value",
                                          "scope" : "G",
                                          "type" : "Property"
                                       }
                                    }
                                 },
                                 "separator" : {
                                    "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                    "value" : " ",
                                    "type" : "Literal"
                                 }
                              }, {
                                 "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                 "value" : " ",
                                 "type" : "Literal"
                              } ]
                           }, {
                              "type" : "Combine",
                              "source" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "F",
                                    "expression" : {
                                       "type" : "Flatten",
                                       "operand" : {
                                          "type" : "Query",
                                          "source" : [ {
                                             "alias" : "$this",
                                             "expression" : {
                                                "path" : "name",
                                                "type" : "Property",
                                                "source" : {
                                                   "name" : "Patient",
                                                   "type" : "ExpressionRef"
                                                }
                                             }
                                          } ],
                                          "where" : {
                                             "type" : "Not",
                                             "operand" : {
                                                "type" : "IsNull",
                                                "operand" : {
                                                   "path" : "family",
                                                   "type" : "Property",
                                                   "source" : {
                                                      "name" : "$this",
                                                      "type" : "AliasRef"
                                                   }
                                                }
                                             }
                                          },
                                          "return" : {
                                             "expression" : {
                                                "path" : "family",
                                                "type" : "Property",
                                                "source" : {
                                                   "name" : "$this",
                                                   "type" : "AliasRef"
                                                }
                                             }
                                          }
                                       }
                                    }
                                 } ],
                                 "relationship" : [ ],
                                 "return" : {
                                    "expression" : {
                                       "path" : "value",
                                       "scope" : "F",
                                       "type" : "Property"
                                    }
                                 }
                              },
                              "separator" : {
                                 "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                 "value" : " ",
                                 "type" : "Literal"
                              }
                           } ]
                        }
                     }, {
                        "name" : "Gender",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "gender",
                              "type" : "Property",
                              "source" : {
                                 "name" : "Patient",
                                 "type" : "ExpressionRef"
                              }
                           }
                        }
                     }, {
                        "name" : "Age",
                        "value" : {
                           "precision" : "Year",
                           "type" : "CalculateAge",
                           "operand" : {
                              "path" : "birthDate.value",
                              "type" : "Property",
                              "source" : {
                                 "name" : "Patient",
                                 "type" : "ExpressionRef"
                              }
                           }
                        }
                     }, {
                        "name" : "MeetsInclusionCriteria",
                        "value" : {
                           "name" : "MeetsInclusionCriteria",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }
               }, {
                  "name" : "PertinentMedicalHistory",
                  "value" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "ConditionsAssociatedWithChronicPain",
                        "value" : {
                           "name" : "ReportConditionsAssociatedWithChronicPain",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "RiskFactorsForOpioidRelatedHarms",
                        "value" : {
                           "name" : "ReportRiskFactorsForOpioidRelatedHarms",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }
               }, {
                  "name" : "PainAssessments",
                  "value" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "NumericPainIntensityAssessments",
                        "value" : {
                           "name" : "ReportNumericPainIntensityAssessments",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "PainEnjoymentGeneralActivityAssessments",
                        "value" : {
                           "name" : "ReportPainEnjoymentGeneralActivityAssessments",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "STarTBackAssessments",
                        "value" : {
                           "name" : "ReportSTarTBackAssessments",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }
               }, {
                  "name" : "HistoricalTreatments",
                  "value" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "OpioidMedications",
                        "value" : {
                           "name" : "ReportOpioidMedications",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "NonOpioidMedications",
                        "value" : {
                           "name" : "ReportNonOpioidMedications",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "NonPharmacologicTreatments",
                        "value" : {
                           "name" : "ReportNonPharmacologicTreatments",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "StoolSoftenersAndLaxatives",
                        "value" : {
                           "name" : "ReportStoolSoftenersAndLaxatives",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }
               }, {
                  "name" : "RiskConsiderations",
                  "value" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "MostRecentMME",
                        "value" : {
                           "name" : "ReportMostRecentMME",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "UrineDrugScreens",
                        "value" : {
                           "name" : "ReportUrineDrugScreens",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "BenzodiazepineMedications",
                        "value" : {
                           "name" : "ReportBenzodiazepineMedications",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "NaloxoneMedications",
                        "value" : {
                           "name" : "ReportNaloxoneMedications",
                           "type" : "ExpressionRef"
                        }
                     }, {
                        "name" : "RiskScreeningsRelevantToPainManagement",
                        "value" : {
                           "name" : "ReportRiskScreeningsRelevantToPainManagement",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }
               } ]
            }
         } ]
      }
   }
}

